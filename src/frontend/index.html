<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protocolo Institucional</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        /* CSS Extra para o formulário dinâmico */
        .hidden-field { display: none; }
        .section-title {
            font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.05em;
            color: var(--text-muted); font-weight: 700; margin: 1.5rem 0 0.5rem 0;
            border-bottom: 1px solid var(--border-color); padding-bottom: 5px;
        }
    </style>
</head>
<body>

    <div class="app-container">
        <aside class="sidebar">
            <div class="brand">
                <i class="ph ph-files-bold"></i>
                <span>Protocolo<span class="highlight">Institucional</span></span>
            </div>
            <nav class="nav-menu">
                <a href="#" class="nav-item active" data-view="dashboard">
                    <i class="ph ph-squares-four"></i> Dashboard
                </a>
                <a href="#" class="nav-item" data-view="documentos">
                    <i class="ph ph-folder-open"></i> Documentos
                </a>
                <a href="#" class="nav-item hidden" id="menuUsuarios" data-view="usuarios">
                    <i class="ph ph-users"></i> Usuários
                </a>
                
                <a href="#" class="nav-item action-btn" id="btnNovoDocumento">
                    <i class="ph ph-plus"></i> Novo Protocolo
                </a>
            </nav>
            <div class="user-profile">
                <div class="avatar">AD</div>
                <div class="info"><span class="name">Administrador</span><span class="role">Setor: Protocolo Geral</span></div>
            </div>
        </aside>

        <main class="main-content">
            <header class="top-bar">
                <h1 id="pageTitle">Visão Geral</h1>
                
                <div style="display:flex; align-items:center; gap: 20px;">
                    <div class="notification-wrapper" style="position: relative;">
                        <button id="btnNotificacoes" class="btn-icon" style="position:relative; background:none; border:none; cursor:pointer; font-size:1.5rem; color:var(--text-muted);">
                            <i class="ph ph-bell"></i>
                            <span id="badgeNotificacao" style="position:absolute; top:-5px; right:-5px; background:var(--danger); color:white; font-size:0.7rem; padding:2px 6px; border-radius:10px; display:none;">0</span>
                        </button>
                        
                        <div id="dropdownNotificacoes" class="notification-dropdown hidden" style="position:absolute; top:100%; right:0; width:300px; background:white; border:1px solid var(--border-color); border-radius:var(--radius); box-shadow:var(--shadow-md); z-index:100;">
                            <div class="dropdown-header" style="padding:10px; border-bottom:1px solid #eee; font-weight:600; font-size:0.9rem;">Notificações</div>
                            <div id="listaNotificacoes" style="max-height:300px; overflow-y:auto;">
                                <div style="padding:10px; text-align:center; color:#999; font-size:0.85rem;">Nenhuma notificação nova.</div>
                            </div>
                        </div>
                    </div>

                    <div class="search-box">
                        <i class="ph ph-magnifying-glass"></i>
                        <input type="text" id="globalSearch" placeholder="Buscar por protocolo, nome, CPF...">
                    </div>
                </div>
            </header>
            <div id="contentArea" class="content-wrapper">
                <div class="loading-spinner">Carregando...</div>
            </div>
        </main>
    </div>

    <div id="modalNovoDocumento" class="modal-overlay hidden">
        <div class="modal-card" style="width: 700px;">
            <div class="modal-header">
                <h2>Novo Requerimento</h2>
                <button class="close-modal"><i class="ph ph-x"></i></button>
            </div>
            
            <form id="formNovoDocumento">
                
                <div class="form-group">
                    <label>Tipo de Requerente</label>
                    <select name="categoria" id="selectCategoria" required style="font-weight:bold; color:var(--primary-color);">
                        <option value="">Selecione o tipo...</option>
                        <option value="Servidor">Servidor Público</option>
                        <option value="Academico">Aluno / Acadêmico</option>
                    </select>
                </div>

                <h3 class="section-title">Dados do Requerente</h3>
                <div class="form-row">
                    <div class="form-group" style="flex: 2;">
                        <label>Nome Completo</label>
                        <input type="text" name="requerente_nome" required>
                    </div>
                    <div class="form-group">
                        <label>CPF</label>
                        <input type="text" name="requerente_cpf" placeholder="000.000.000-00" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Matrícula</label>
                        <input type="text" name="requerente_matricula" required>
                    </div>
                    <div class="form-group">
                        <label>Telefone</label>
                        <input type="text" name="requerente_telefone">
                    </div>
                    <div class="form-group">
                        <label>E-mail</label>
                        <input type="email" name="requerente_email">
                    </div>
                </div>

                <div id="fieldsServidor" class="hidden-field">
                    <h3 class="section-title">Dados Funcionais</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Cargo</label>
                            <input type="text" name="cargo">
                        </div>
                        <div class="form-group">
                            <label>Lotação / Órgão</label>
                            <input type="text" name="lotacao">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Assunto (Servidor)</label>
                        <select name="assunto_servidor" id="assuntoServidor">
                            <option value="">Selecione...</option>
                            <optgroup label="Afastamentos">
                                <option value="Incentivo à Formação">Incentivo à Formação Profissional</option>
                                <option value="Missão ou Estudo">Missão ou Estudo</option>
                                <option value="Pós-Graduação">Participar de Pós-Graduação</option>
                            </optgroup>
                            <optgroup label="Licenças">
                                <option value="Licença Prêmio">Licença Prêmio por Assiduidade</option>
                                <option value="Tratamento de Saúde">Tratamento de Saúde</option>
                                <option value="Interesse Particular">Tratar de Interesses Particulares</option>
                                <option value="Licença Maternidade/Paternidade">Maternidade/Paternidade</option>
                            </optgroup>
                            <optgroup label="Diversos">
                                <option value="Aposentadoria">Aposentadoria</option>
                                <option value="Averbação de Tempo">Averbação de Tempo</option>
                                <option value="Auxílio Natalidade">Auxílio Natalidade</option>
                                <option value="Progressão Funcional">Progressão Funcional</option>
                            </optgroup>
                        </select>
                    </div>
                </div>

                <div id="fieldsAcademico" class="hidden-field">
                    <h3 class="section-title">Dados Acadêmicos</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Curso</label>
                            <input type="text" name="curso">
                        </div>
                        <div class="form-group">
                            <label>Centro / Campus</label>
                            <input type="text" name="centro">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Programa / Polo</label>
                        <input type="text" name="programa" placeholder="Ex: UEMANET, ENSINAR...">
                    </div>
                    <div class="form-group">
                        <label>Assunto (Acadêmico)</label>
                        <select name="assunto_academico" id="assuntoAcademico">
                            <option value="">Selecione...</option>
                            <option value="Cancelamento de Disciplina">Cancelamento de Disciplina</option>
                            <option value="Trancamento de Matrícula">Trancamento de Matrícula</option>
                            <option value="Aproveitamento de Estudos">Aproveitamento de Estudos</option>
                            <option value="Certidão de Conclusão">Certidão de Conclusão</option>
                            <option value="Histórico Escolar">Histórico Escolar</option>
                            <option value="Prova 2ª Chamada">Prova de 2ª Chamada</option>
                            <option value="Justificativa de Faltas">Justificativa de Faltas</option>
                            <option value="Exercício Domiciliar">Exercício Domiciliar</option>
                        </select>
                    </div>
                </div>

                <div class="form-group" style="margin-top: 1rem;">
                    <label>Documento Digitalizado (PDF)</label>
                    <div class="file-upload-wrapper">
                        <input type="file" name="arquivo_pdf" accept="application/pdf" required>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn-secondary close-modal">Cancelar</button>
                    <button type="submit" class="btn-primary">Protocolar</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modalEditarDocumento" class="modal-overlay hidden">
        <div class="modal-card" style="width: 700px;">
            <div class="modal-header">
                <h2>Editar Documento</h2>
                <button class="close-modal"><i class="ph ph-x"></i></button>
            </div>
            <form id="formEditarDocumento">
                <input type="hidden" name="id" id="editDocId">
                <input type="hidden" name="categoria" id="editCategoriaHidden">
                
                <h3 class="section-title">Dados Básicos</h3>
                <div class="form-row">
                    <div class="form-group" style="flex: 2;">
                        <label>Nome Completo</label>
                        <input type="text" name="requerente_nome" id="editNome" required>
                    </div>
                    <div class="form-group">
                        <label>CPF</label>
                        <input type="text" name="requerente_cpf" id="editCpf" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Matrícula</label>
                        <input type="text" name="requerente_matricula" id="editMatricula">
                    </div>
                    <div class="form-group">
                        <label>Telefone</label>
                        <input type="text" name="requerente_telefone" id="editTelefone">
                    </div>
                    <div class="form-group">
                        <label>E-mail</label>
                        <input type="email" name="requerente_email" id="editEmail">
                    </div>
                </div>

                <div id="editExtraFields"></div>

                <div class="form-group">
                    <label>Assunto</label>
                    <input type="text" name="assunto" id="editAssunto" required>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn-secondary close-modal">Cancelar</button>
                    <button type="submit" class="btn-primary">Salvar Alterações</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modalTramitar" class="modal-overlay hidden">
        <div class="modal-card">
            <div class="modal-header"><h2>Tramitar Documento</h2><button class="close-modal"><i class="ph ph-x"></i></button></div>
            <form id="formTramitar">
                <input type="hidden" name="documento_id" id="tramitarDocId">
                <div class="form-group"><p class="info-text">Protocolo: <strong id="tramitarProtocoloDisplay">...</strong></p></div>
                <div class="form-group"><label>Destino</label><select name="setor_destino_id" id="selectSetorDestino" required></select></div>
                <div class="form-group"><label>Despacho</label><textarea name="despacho" rows="4" required></textarea></div>
                <div class="modal-footer"><button type="button" class="btn-secondary close-modal">Cancelar</button><button type="submit" class="btn-primary">Enviar</button></div>
            </form>
        </div>
    </div>
    <div id="toast" class="toast hidden"></div>
    <script type="module" src="js/app.js"></script>
</body>
</html>